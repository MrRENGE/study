### JavaScript代码编译路程

​		通常说JavaScript语言是一门动态或者是解释性语言，带来不需要编译直接解释执行等认知误区。其实 JavaScript 语言是需要经行编译后执行的，也有说成预编译总之什么描述都指向--编译。主要分为三个部分，词法分析、语法解析、代码生成。

* 词法分析

  编写代码始终是一堆字符串，根据JavaScript语言此法单元生成器规则进行差分解析。将代码解析为一个个的词法单元。

* 语法分析

  语法分析将词法分析后的词法单元数组流转换为一棵由词法元素逐级嵌套组成的语法解析树。称为抽象语法树（AST）。

* 代码生成

  将语法解析树转换为可执行代码，一般转化为机器指令。因此是与平台/语言相关的。具体的变量内存分配等细节都是代码转换为机器指令来实现。

通常JavaScript 编译过程会进行性能优化，优化的发生时间在语法分析和代码生成这两个步骤。将根据规则优化代码的执行顺序，因此实际上代码的编写顺序和执行顺序不一定相同。所以动态更改代码作用域，欺骗词法环境等代码编写方式会破坏掉优化。常见的有 eval ,with、 new Function ，eval 函数中可以传递字符串代码如果在其中进行变量申明函数定义等操作将会影响当前的词法环境，因此提前优化就是没有必要的，编译器可能就不会进行优化。with 也是一样，访问限定域中不存在的属性时，会定位到全局上如果全局不存在该变量 LSH 会创建新的变量，因此全局词法环境也是被修改破坏。

### 函数作用域

函数作为在作用域中级联的气泡，函数是一个按照最小暴露原则将部分代码块进行封装的代码块。通常函数封装部分代码块有助于，隐藏内部实现、规避作用域中命名冲突等优点。此处鉴于介绍函数作用域，因此其他的优点不做过多介绍。函数内部作用域，包含函数参数以及内部定义的变量、函数。当进行变量访问时会从当前作用域查找变量，如果找不到向父级作用域进行查找如果到全局作用域也找不到则报错（区分严格模式和非严格模式，报错类型也区分LHS和RHS）。注意原型链遍历对象属性的异同。其中也有一些不同函数使用方式如：匿名函数与具名函数、立即执行函数

* 匿名函数表达式

  多用在回调函数中，函数的定义又可写成表达式定义函数`  setTimeout(function(){},100)` 抑或` const foo = function (){}` 。固然写法简单，但是存在几个使用的缺点。

  + 匿名函数在进行调用栈追踪时不会显示有意义的函数名，不便于调试
  + 递归执行自身只能使用过时的 `argument.callee` 来访问当前函数的引用。
  + 匿名函数对于复杂函数的理解要稍微复杂些，因为函数名一般用来表示函数功能

* 立即执行函数

  立即执行函数写法为在` (function(window){}(window))`  或者`（function（window）{})（window）` ，会在函数中定义一些私有的变量，外部无法访问到内部变量。



### 块级作用域

函数作用域作为JavaScript作用域的常见的单元，JavaScript也存在其他的块级作用域。比如：try/catch 中的catch代码块就是一个独立的块作用域，with 关键字也可以形成一个块级作用域。大了来说一堆`{}` 包含的就是一个块，`es6 `中引入`let、const`  更明显的展现出块级作用域的范围。常见在 for 循环中，if 条件内申明的变量都是仅在当前块内可访问。具体的作用细节不便于在总结性文章中细说。