# 从URL输入到页面展示

 ## 输入url

​	从浏览器输入url浏览器会进行智能匹配缓存或者历史记录中的域名，进行自动补全。chrome还可以从缓存中加载对应页面。

## 域名解析过程（寻找ip地址）

​	浏览器获取到URL后会进行解析域名，首先会通过访问本地的 hosts 文件查找是否存在url（域名地址）对应的IP，存在直接只用该IP。不存在则向本地DNS服务器发起请求，本地域名系统首先在缓存中查找是否存在域名对应的IP地址信息，如果不存在本地DNS继续向根DNS发起查询请求，此时根DNS服务器进行递归的向下查找，直到找到对应的信息然后返回给本地DNS。迭代查询，局部DNS服务器将能查询到的域名信息的DNS服务器地址返回给本地DNS。（告诉本地DNS该去什么）



1. 首先根据域名查找本地的hosts文件，如果存在对应的信息直接返回，解析结束。
2. hosts文件中没有该域名对应的IP地址信息，则查找本地DNS解析缓存。找到直接返回解析结束
3. 本地DNS解析缓存中没有对应的信息，则根据TCP/ip指定的首选DNS服务器地址查找，这是本地DNS服务器。
4. 本地DNS服务器缓存中未找打对应的信息，则根据是否设置转发模式进行查找。转发模式，向上级域名系统转发请求递归进行直到找到信息，非转发模式，则向根域名系统发起查找根域名系统向下进行查询。
5. 最后将返回的信息传到本地 DNS 服务器。本地服务器再将信息（成功的信息或者错误的信息）返回给主机。

注意：区分迭代查询和递归查询

* 递归查询

  主机向本地DNS服务器发起的查询一般都是递归查询，本地服务器找不到域名对应的信息，则代表主机向其他根域名服务器发起请求，而不是让主机进行请求。因此得到的结果会是对应的IP信息、或者报错信息。

* 迭代查询

  当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的IP地址，要么告诉本地服务器：“你下一步应当向哪一个域名服务器进行查询”。

  ​        然后让本地服务器进行后续的查询。根域名服务器通常是把自己知道的顶级域名服务器的IP地址告诉本地域名服务器，让本地域名服务器再向顶级域名服务器查询。

  ​        顶级域名服务器在收到本地域名服务器的查询请求后，要么给出所要查询的IP地址，要么告诉本地服务器下一步应当向哪一个权限域名服务器进行查询。

  ​        最后，知道了所要解析的IP地址或报错，然后把这个结果返回给发起查询的主机。

##　通过http发起请求

​	得到IP地址之后，客户端向目标服务器80端口发起请求。请求报文通过网络（此处省略计算机网络通信以及协议栈部分细节）通过 tcp/ip 三次握手建立连接（这部分详见另外一篇文章）。然后通过get、post、head、put、delete、等请求方式发起http 请求。

##　web Server 执行操作

根据路由执行对应 controller ，

## 浏览器展示过程

​	当 http 请求返回数据后，根据 body 进行内容渲染。不管什么服务端状态码，对应的页面都需要解析渲染。

* 解析 HTML 节点成为DOM 树
* 同时解析 CSS 构建CSSOM (也说CSS 抽象语法树)
* 结合DOM和CSSOM 生成Render Tree 渲染树
* 然后根据渲染树计算形成位图，调用操作系统底层实现将位图渲染到展示